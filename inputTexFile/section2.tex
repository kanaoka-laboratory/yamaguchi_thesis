\newpage
\section{前提知識}

本研究における前提知識を解説する。

%%%%%%%%%%%%%%%%%%%Android%%%%%%%%%%%%%%%%%%%%
\subsection{Android}
Androidとは、Googel社が2007年に開発したスマートフォンやタブレット端末など携帯情報機器向けのOperating System、あるいはAndroid OSが搭載された端末を指す。主にスマートフォンのOSとして広く普及しており、世界的にApple社の携帯機器向けiOSと市場を二分している\cite{StatCounter Global Stats}。


%%%%%%%%%%%%%%%%%%%Operating System%%%%%%%%%%%%%%%%%%%%
\subsection{Operating System}
Operating System(以後OS)とは、ソフトウェアの種類の1つで、機器の基本的な管理や制御のための機能や、多くのソフトウェアが共通して利用する基本的な機能などを実装したシステム全体を管理するソフトウェアのことである。

\if0
%%%%%%%%%%%%%%%%%%%アプリケーション%%%%%%%%%%%%%%%%%%%%
\subsection{アプリケーション}

アプリケーションとは、Application Softwareの略であり、ゲームや音楽プレイヤー、メールなど、スマートフォンのOS上で動くソフトウェアのことを言う。
\fi

%%%%%%%%%%%%%%%%%%%Androidアプリ%%%%%%%%%%%%%%%%%%%%
\subsection{Androidアプリケーション}
Androidアプリケーションとは、Androidにインストール可能なアプリケーションである。
主に、JavaやKotlinなどのプログラミング言語で作成されている。Javaプログラムをコンパイルして機械語に変換し、
画像などのリソースと合わせてパッケージにすることでインストール可能である。


%%%%%%%%%%%%%%%%%%%APK%%%%%%%%%%%%%%%%%%%%
\subsection{APK}
APKとは、Android Application Packageの略であり、Android向けのをAndroid端末にインストールできる形式にパッケージにしたもの、もしくはそのファイルのことである。
入手方法はAPKストアからダウンロードする方法や、単体で公開されているAPKファイルをダウンロードする方法等が存在する。
一般的にAPKは“.apk”拡張子を持つ。ただし、APKファイル自体はzip形式で圧縮されており、その中にはアプリケーションの動作に必要なさまざまなファイルが納められている。
.apkファイルに対してzipファイルと同様の解凍処理を行い、得られるファイルのうち本研究に関連する項目を解説する。
\begin{itemize}
	\item  AndroidManifest.xml
		\begin{itemize}
			\item Androidアプリケーションの必要要件や、最初に起動されるアクティビティの記述がされている
			\item zipの解凍処理により得られるAndroifManifest.xmlはバイナリファイルの状態であるため、テキストエディタ等で内容を閲覧するためにはデコード処理が必要である
		\end{itemize}
	\item classes.dex
		\begin{itemize}
			\item Androidアプリケーションのソースファイルを変換してAndroidで実行可能なようにまとめたファイルである
			　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　%実行できるように　or 　実行可能なようにどっちらの方が正しいのでしょうか
			\item 1つのdexファイルに含められるメソッドの数は65,536が上限であり、それ以上の数のメソッドが1つのAndroidアプリケーションに含まれる場合は、classes2.dex、classes3.dex…と複数ファイルに分割される
		\end{itemize}
\end{itemize}


%%%%%%%%%%%%%%%%%%%バイナリファイル%%%%%%%%%%%%%%%%%%%%
\subsection{バイナリファイル}
バイナリファイルとは、コンピュータプログラムによって読み書きや処理を行うことを前提に、文字コードの規約を用いずに任意のビット列によって構成されるデータを格納するものである。
%一方、テキストファイルは文字コードで規定された自然言語の文字と、表示制御のための少数の制御コード
%（空白や改行など）のみを含み、人間が容易に読み書き可能である。
%テキストファイルはテキストエディタなどで表示して中にどんな文字が書かれているかを読むことが可能だが、
バイナリファイルはその形式に対応したソフトウェア以外で内容を知ることは不可能である。
ただし、バイナリエディタ
%というソフトウェア
によってどのようなバイト列が並んでいるかを見ることが可能である。


%%%%%%%%%%%%%%%%%%%APKストア%%%%%%%%%%%%%%%%%%%%
\subsection{APKストア}
APKストアとは、Androidアプリケーション開発者の作成したAndroidアプリケーションの配信を代行するサービス、およびそれを行っているWebサイトのことである。Androidの公式APKストアは、Android の公式APKストアであるGooglePlay\cite{GooglePlay}のみであり、非公式のAPKストアは数多く存在する。


%%%%%%%%%%%%%%%%%%%Android Developers%%%%%%%%%%%%%%%%%%%%
\subsection{Android Developers}
Android Developers とは、Androidアプリケーション開発者向けのAndroid公式Webサイトのことである\cite{Android_Developers}。Androidの詳細やドキュメントが提供されている。
本論では、公式ドキュメントといった場合Android Developersを指す。


%%%%%%%%%%%%%%%%%%%smaliファイル%%%%%%%%%%%%%%%%%%%%
\subsection{smaliファイル}
smaliファイルとは、Javaをコンパイルした後の機械語の状態のファイルである。
通常、Androidアプリケーションに含まれている実行可能ファイルである。
DEX(Dalvik Executable、Dalvik実行可能）ファイル（APKファイル）を逆コンパイルすることによって作成される。
smaliファイルの取得には、Apktool\cite{Apktool}を用いる方法と、Baksmali\cite{Baksmali}を用いる方法がある。



%%%%%%%%%%%%%%%%%%%中間言語%%%%%%%%%%%%%%%%%%%%
\subsection{中間言語}
中間言語とは、計算機が実行するコードを人間が理解できる形式で表現するための言語である。
以下に本研究に関連するDalvikバイトコードについての詳細な説明を述べる。


%%%%%%%%%%%%%%%%%%%Dalvikバイトコード%%%%%%%%%%%%%%%%%%%%
\subsubsection{Dalvikバイトコード}
Dalvikバイトコードとは、Androidにおける中間言語である。Apktool等を用いてAPKより取得できるsmaliファイルは、Dalvikバイトコードで記述されている。以下のソースコード 1、ソースコード2に、Dalvikバイトコードの例と対応するソースコードを示す。

\lstinputlisting[caption=Dalvikバイトコードの例,label=BytecodeSample.smali]{C:/Users/arier/Documents/卒論/yamaguchi_thesis-main/コード/BytecodeSample.smali}
\lstinputlisting[caption=Listing1のバイトコードに対応するソースコード,label=BytecodeSample.java]{C:/Users/arier/Documents/卒論/yamaguchi_thesis-main/コード/BytecodeSample.java}


%%%%%%%%%%%%%%%%%%%CUI%%%%%%%%%%%%%%%%%%%
\subsection{CUI}
CUIとは、Character User Interfaceの略であり、コンピュータやソフトウェアが利用者に情報を提示したり操作を受け付けたりする方法の1つで、
すべてのやり取りを文字によって行う方式のことである。


%%%%%%%%%%%%%%%%%%%Linux%%%%%%%%%%%%%%%%%%%
\subsection{Linux}
Linuxとは、Linuxカーネルを利用しているUNIX系のOSである。
主にネットワーク上で他のコンピュータに機能やサービスを提供するサーバコンピュータ用として利用されるほか、
スマートフォンなどの携帯端末から一般的なパソコン、家庭用ゲーム機やデジタル家電、スーパーコンピュータまで、
様々な種類や用途のコンピュータ製品に組み込まれ広く普及している。


%%%%%%%%%%%%%%%%%%%Linuxカーネル%%%%%%%%%%%%%%%%%%%
\subsection{Linuxカーネル}
Linuxカーネルとは、OSに必要な基本機能を集めた核となるソフトウェアのことである。


%%%%%%%%%%%%%%%%%%%Linuxディストリビューション%%%%%%%%%%%%%%%%%%%
\subsection{Linuxディストリービューション}
Linuxディストリービューションとは、Linuxカーネルに加えてOSとして機能するよう必要なプログラム群を合わせた配布パッケージを指す。
カーネルを利用者がコンピュータに導入して操作可能な状態にするために作成されている。
Linuxディストリビューションは自由に開発・配布できるため、個人や数人のグループから企業、大規模オープンソースプロジェクトまで様々な開発主体が様々な機種・用途向けのものを提供している。
その中の1つに、パソコン向けやサーバ向けとしてUbuntuがある。
Ubuntuは、シェルスクリプトやsmaliファイル解析に用いる環境が整っていることから本研究ではUbuntuを利用した。


%%%%%%%%%%%%%%%%%%%シェル%%%%%%%%%%%%%%%%%%%
\subsection{シェル}
シェルとは、オペレーティングシステムと対話するためのインターフェイスであり、コマンドなどを制御する環境のことである。
シェルがあることでコマンドを受付、OSとの対話が可能である。CUI環境においてシェルは最も身近なインターフェイスである。


%%%%%%%%%%%%%%%%%%%UNIXコマンド%%%%%%%%%%%%%%%%%%%
\subsection{UNIXコマンド}
UNIXコマンドとは、Linux OS等のUNIXマシンにおいてCUI上からコンピュータを操作するために使用するコマンドを指す。ファイルのコピーを行うcp、ファイルの内容を表示するcat、ディレクトリの内容を表示するlsなどが存在する。


%%%%%%%%%%%%%%%%%%%シェルスプリクト%%%%%%%%%%%%%%%%%%%%
\subsection{シェルスプリクト}
シェルスプリクトとは、OSを操作するためのシェル上で実行できる簡易なプログラム言語（スプリクト言語）のことを言う。また、スプリクト言語によって書かれた、複数のOSコマンドや制御文などを組み合わせたプログラムを指す。
shコマンドの引数としてシェルスクリプトのファイルを与えて実行すると、ファイルに記述されたUNIXコマンドが上から順に実行される。ソースコード3のシェルスクリプトを実行すると、a.txtがb.txtにコピーされ、a.txtの末尾に“hoge”の文字列が追加される。
\lstinputlisting[caption=シェルスクリプトの例,label=ShellScriptSample.sh]{C:/Users/arier/Documents/卒論/yamaguchi_thesis-main/コード/ShellScriptSample.sh}


%%%%%%%%%%%%%%%%%%%%正規表現%%%%%%%%%%%%%%%%%%%%
\subsection{正規表現}

正規表現とは，ある文字列の規則を表現する方法である。
正規表現ではメタ文字と呼ばれる特別な意味を持つ文字や記号が存在する。
基本的なメタ文字を表\ref{tb:RegularExpression}に示す。
ある文字列の中から通常の文字とメタ文字によって作られた特定の規則に当てはまる文字列を検索するときに利用される。
正規表現の例を表\ref{tb:RegularExpression2}に示す。

\begin{table}[t]
\begin{center}
\caption{正規表現における基本的なメタ文字の一覧}
\begin{tabular}{ll} \hline
. & 任意の1文字 \\
$\ast$ & 直前のパターンの0回以上繰り返し(最長一致) \\
+ & 直前のパターンの1回以上繰り返し(最長一致) \\
? & 直前のパターンの0～1回繰り返し(最長一致) \\ \hline
\end{tabular}
\label{tb:RegularExpression}
\end{center}
\end{table}

\begin{table}[t]
\begin{center}
\caption{正規表現の例}
\begin{tabular}{lll} \hline
正規表現の例 & 正規表現の例の意味 & マッチする例 \\ \hline
. & 任意の1文字 & a \\
and$\ast$roid & anとdの0回以上の繰り返しとroidからなる文字列 & anroid \\
and+roid & anとdの1回以上の繰り返しとroidからなる文字列 & anddddddroid \\
and?roid & anとdの0回～1回の繰り返しとroidからなる文字列 & android \\ \hline
\end{tabular}
\label{tb:RegularExpression2}
\end{center}
\end{table}

%%%%%%%%%%%%%%%%%%%暗号技術%%%%%%%%%%%%%%%%%%%%
\subsection{暗号技術}

\subsubsection {MD5}
MD5とは、Message Digest algorithm 5の略であり、ハッシュ値を計算するためのハッシュ関数の1つである。RSA暗号の開発者の1人、ロン・リベスト氏らによって開発された。IPsecや、POP before SMTPなど、さまざまなセキュリティプロトコルで使われている一方、最近になって脆弱性も指摘されている。
ハッシュ関数により生成された値は「ハッシュ値」と呼ばれる。MD5のハッシュ値は、128bitである。

\subsubsection {SHA-1}
SHA-1とは、アメリカ国家安全保障局が考案し、1995年から米国政府の標準として使用されているハッシュ関数である。任意のデータから160bitのハッシュ値を生成する。
2017年、GoogleがSHA-1でハッシュ値が衝突する事例\cite{INTERNET Watch}を発見したため、より安全なハッシュ関数を使用することが推奨されている。

\subsubsection{SHA-2}
SHA-2とは、SHA-1を改良したハッシュ関数である。このハッシュ関数は、バリエーション豊富であり以下を総称してSHA-2と呼ばれている。
\begin{itemize}
\item SHA-224（ハッシュ値：224bit）
\item SHA-256（ハッシュ値：256bit）
\item SHA-384（ハッシュ値：384bit）
\item SHA-512（ハッシュ値：512bit）
\item SHA-512/224（ハッシュ値：224bit）
\item SHA-512/256（ハッシュ値：256bit）
\end{itemize}
基本となるアルゴリズムは、SHA-256とSHA-512である。
SHA-224はSHA-256で出力されたハッシュ値を224bitに切り詰めたものであり、SHA-384はSHA-512で出力されたハッシュ値を384bitに切り詰めたものである。
SHA-512/224とSHA-512/256についてもSHA-512で出力されたハッシュ値を224bit、256bitに切り詰めたものである。
大きな違いとしては、SHA-256は32bitCPU、SHA-512は64bitCPUに最適化されている点がある。
ハッシュ長が長い方がセキュリティ的な強度が高いが、負荷が高くなる。
ただし、現状SHA-256でも必要十分な強度となっているため、SHA-256が利用されている。


%%%%%%%%%%%%%%%%%%%API%%%%%%%%%%%%%%%%%%%
\subsection{API}
APIとは、Application Programming Interfaceの略であり、あるコンピュータプログラム（ソフトウェア）の機能や管理するデータなどを、外部の他のプログラムから呼び出して利用するための手順やデータ形式などを定めた規約である。\\APKに使用されているAPIは大きく分けて3種類存在する。詳細は、\ref{sec:APIの分類}で説明する。
\if0
\subsubsection {公式API}
Androidの開発者向け公式WebサイトであるAndroid DevelopersのAPIリファレンスに記載されているAPIのことを本研究では公式APIと呼ぶこととする。
Androidでは、ソフトウェア開発のために必要なプログラムやライブラリをGoogle社がAndroid SDKとして提供してる。SDKで提供されるライブラリはAndroid開発者向けサイトAndroid DevelopersにAPIリファレンスとして記載されてる。
\subsubsection {サードパーティー製API}

サードパーティー製APIとは、サードパーティが提供するAPIのことである。
サードパーティとは、特定のハードウェア、OS、ソフトウェア、あるいはサービスなどを対象として、
それに対応する製品を販売、提供している組織や企業のことを指す。

\subsubsection {独自実装等のAPI}
API開発者が既存のAPIを利用せずに独自に実装したAPIや、先述2つに含まれないものを独自実装等のAPIと本論文では呼ぶこととする。

\fi

%%%%%%%%%%%%%%%%%%%APIドキュメント%%%%%%%%%%%%%%%%%%%
\subsection{APIドキュメント}
APIドキュメントとは、APIによる開発方法やクラス内のメソッドの使用方法を解説した説明書である。
APIリファレンス\cite{API_reference}とも呼ばれる。




























